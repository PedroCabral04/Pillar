@using erp.DTOs.Financial

<MudDialog>
    <DialogContent>
        <MudForm @ref="form" @bind-IsValid="@success">
            <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-4">
                <MudTabPanel Text="Dados Gerais">
                    <MudGrid>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="Model.Name" Label="Razão Social" Required="true" RequiredError="Razão Social é obrigatória" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="Model.TradeName" Label="Nome Fantasia" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="Model.TaxId" Label="CNPJ/CPF" Required="true" RequiredError="CNPJ/CPF é obrigatório" />
                        </MudItem>
                        <MudItem xs="12" sm="3">
                            <MudTextField @bind-Value="Model.StateRegistration" Label="Inscrição Estadual" />
                        </MudItem>
                        <MudItem xs="12" sm="3">
                            <MudTextField @bind-Value="Model.MunicipalRegistration" Label="Inscrição Municipal" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="Model.Email" Label="Email" InputType="InputType.Email" />
                        </MudItem>
                        <MudItem xs="12" sm="3">
                            <MudTextField @bind-Value="Model.Phone" Label="Telefone" />
                        </MudItem>
                        <MudItem xs="12" sm="3">
                            <MudTextField @bind-Value="Model.MobilePhone" Label="Celular" />
                        </MudItem>
                        <MudItem xs="12">
                            <MudTextField @bind-Value="Model.Website" Label="Website" />
                        </MudItem>
                    </MudGrid>
                </MudTabPanel>
                <MudTabPanel Text="Endereço">
                    <MudGrid>
                        <MudItem xs="12" sm="4">
                            <MudTextField @bind-Value="Model.ZipCode" Label="CEP" />
                        </MudItem>
                        <MudItem xs="12" sm="8">
                            <MudTextField @bind-Value="Model.Street" Label="Logradouro" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudTextField @bind-Value="Model.Number" Label="Número" />
                        </MudItem>
                        <MudItem xs="12" sm="8">
                            <MudTextField @bind-Value="Model.Complement" Label="Complemento" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudTextField @bind-Value="Model.District" Label="Bairro" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudTextField @bind-Value="Model.City" Label="Cidade" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudTextField @bind-Value="Model.State" Label="Estado" />
                        </MudItem>
                    </MudGrid>
                </MudTabPanel>
                <MudTabPanel Text="Financeiro">
                    <MudGrid>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="Model.Category" Label="Categoria" />
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudTextField @bind-Value="Model.PaymentMethod" Label="Método de Pagamento Padrão" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudNumericField @bind-Value="Model.PaymentTermDays" Label="Prazo de Pagamento (dias)" Min="0" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudNumericField @bind-Value="Model.DeliveryLeadTimeDays" Label="Prazo de Entrega (dias)" Min="0" />
                        </MudItem>
                        <MudItem xs="12" sm="4">
                            <MudNumericField @bind-Value="Model.MinimumOrderValue" Label="Pedido Mínimo" Format="C2" />
                        </MudItem>
                        <MudItem xs="12">
                            <MudCheckBox @bind-Value="Model.IsPreferred" Label="Fornecedor Preferencial" Color="MudBlazor.Color.Primary" />
                        </MudItem>
                    </MudGrid>
                </MudTabPanel>
                <MudTabPanel Text="Observações">
                    <MudTextField @bind-Value="Model.Notes" Label="Observações" Lines="5" />
                    <MudCheckBox @bind-Value="Model.IsActive" Label="Ativo" Color="MudBlazor.Color.Success" Class="mt-4" />
                </MudTabPanel>
            </MudTabs>
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancelar</MudButton>
        <MudButton Color="MudBlazor.Color.Primary" OnClick="Submit">Salvar</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] IMudDialogInstance MudDialog { get; set; }
    [Parameter] public CreateSupplierDto Model { get; set; } = new() { Name = "", TaxId = "" };

    private MudForm form;
    private bool success;

    private void Cancel() => MudDialog.Cancel();

    private async Task Submit()
    {
        await form.Validate();
        if (success)
        {
            MudDialog.Close(DialogResult.Ok(Model));
        }
    }
}
